{
    "abstractText": "We present persona-based models for handling the issue of speaker consistency in neural response generation. A speaker model encodes personas in distributed embeddings that capture individual characteristics such as background information and speaking style. A dyadic speakeraddressee model captures properties of interactions between two interlocutors. Our models yield qualitative performance improvements in both perplexity and BLEU scores over baseline sequence-to-sequence models, with similar gains in speaker consistency as measured by human judges.",
    "authors": [
        {
            "affiliations": [],
            "name": "Jiwei Li"
        },
        {
            "affiliations": [],
            "name": "Michel Galley"
        },
        {
            "affiliations": [],
            "name": "Chris Brockett"
        },
        {
            "affiliations": [],
            "name": "Georgios P. Spithourakis"
        },
        {
            "affiliations": [],
            "name": "Jianfeng Gao"
        },
        {
            "affiliations": [],
            "name": "Bill Dolan"
        }
    ],
    "id": "SP:a8de2f2ddc0ceeb225ab8054029966aac0d1ff65",
    "references": [
        {
            "authors": [
                "David Ameixa",
                "Luisa Coheur",
                "Pedro Fialho",
                "Paulo Quaresma."
            ],
            "title": "Luke, I am your father: dealing with out-of-domain requests by using movies subtitles",
            "venue": "Intelligent Virtual Agents, pages 13\u201321. Springer.",
            "year": 2014
        },
        {
            "authors": [
                "Dzmitry Bahdanau",
                "Kyunghyun Cho",
                "Yoshua Bengio."
            ],
            "title": "Neural machine translation by jointly learning to align and translate",
            "venue": "Proc. of the International Conference on Learning Representations (ICLR).",
            "year": 2015
        },
        {
            "authors": [
                "Rafael E Banchs",
                "Haizhou Li."
            ],
            "title": "IRIS: a chatoriented dialogue system based on the vector space model",
            "venue": "Proc. of the ACL 2012 System Demonstrations, pages 37\u201342.",
            "year": 2012
        },
        {
            "authors": [
                "Yun-Nung Chen",
                "Wei Yu Wang",
                "Alexander Rudnicky."
            ],
            "title": "An empirical investigation of sparse log-linear models for improved dialogue act classification",
            "venue": "Acoustics, Speech and Signal Processing (ICASSP), 2013 IEEE International Conference on,",
            "year": 2013
        },
        {
            "authors": [
                "Werner Deutsch",
                "Thomas Pechmann."
            ],
            "title": "Social interaction and the development of definite descriptions",
            "venue": "Cognition, 11:159\u2013184.",
            "year": 1982
        },
        {
            "authors": [
                "Michel Galley",
                "Chris Brockett",
                "Alessandro Sordoni",
                "Yangfeng Ji",
                "Michael Auli",
                "Chris Quirk",
                "Margaret Mitchell",
                "Jianfeng Gao",
                "Bill Dolan."
            ],
            "title": "\u2206BLEU: A discriminative metric for generation tasks with intrinsically diverse targets",
            "venue": "Proc. of",
            "year": 2015
        },
        {
            "authors": [
                "Jianfeng Gao",
                "Xiaodong He",
                "Wen-tau Yih",
                "Li Deng."
            ],
            "title": "Learning continuous phrase representations for translation modeling",
            "venue": "Proc. of ACL, pages 699\u2013709, Baltimore, Maryland.",
            "year": 2014
        },
        {
            "authors": [
                "Sepp Hochreiter",
                "J\u00fcrgen Schmidhuber."
            ],
            "title": "Long short-term memory",
            "venue": "Neural computation, 9(8):1735\u20131780.",
            "year": 1997
        },
        {
            "authors": [
                "Alfred Kobsa."
            ],
            "title": "User modeling in dialog systems: Potentials and hazards",
            "venue": "AI & society, 4(3):214\u2013231.",
            "year": 1990
        },
        {
            "authors": [
                "Esther Levin",
                "Roberto Pieraccini",
                "Wieland Eckert."
            ],
            "title": "A stochastic model of human-machine interaction for learning dialog strategies",
            "venue": "IEEE Transactions on Speech and Audio Processing, 8(1):11\u201323.",
            "year": 2000
        },
        {
            "authors": [
                "Jiwei Li",
                "Michel Galley",
                "Chris Brockett",
                "Jianfeng Gao",
                "Bill Dolan."
            ],
            "title": "A diversity-promoting objective function for neural conversation models",
            "venue": "Proc. of NAACL-HLT.",
            "year": 2016
        },
        {
            "authors": [
                "Grace I Lin",
                "Marilyn A Walker."
            ],
            "title": "All the world\u2019s a stage: Learning character models from film",
            "venue": "Proceedings of the Seventh AAAI Conference on Artificial Intelligence and Interactive Digital Entertainment (AIIDE).",
            "year": 2011
        },
        {
            "authors": [
                "Thang Luong",
                "Ilya Sutskever",
                "Quoc Le",
                "Oriol Vinyals",
                "Wojciech Zaremba."
            ],
            "title": "Addressing the rare word problem in neural machine translation",
            "venue": "Proc. of ACL, pages 11\u201319, Beijing, China, July.",
            "year": 2015
        },
        {
            "authors": [
                "Lasguido Nio",
                "Sakriani Sakti",
                "Graham Neubig",
                "Tomoki Toda",
                "Mirna Adriani",
                "Satoshi Nakamura."
            ],
            "title": "Developing non-goal dialog system based on examples of drama television",
            "venue": "Natural Interaction with Robots, Knowbots and Smartphones, pages 355\u2013361.",
            "year": 2014
        },
        {
            "authors": [
                "Franz Josef Och."
            ],
            "title": "Minimum error rate training in statistical machine translation",
            "venue": "Proceedings of the 41st Annual Meeting of the Association for Computational Linguistics, pages 160\u2013167, Sapporo, Japan, July. Association for Computational Linguistics.",
            "year": 2003
        },
        {
            "authors": [
                "Alice H Oh",
                "Alexander I Rudnicky."
            ],
            "title": "Stochastic language generation for spoken dialogue systems",
            "venue": "Proceedings of the 2000 ANLP/NAACL Workshop on Conversational systems-Volume 3, pages 27\u201332.",
            "year": 2000
        },
        {
            "authors": [
                "Kishore Papineni",
                "Salim Roukos",
                "Todd Ward",
                "WeiJing Zhu."
            ],
            "title": "BLEU: a method for automatic evaluation of machine translation",
            "venue": "Proc. of ACL, pages 311\u2013318.",
            "year": 2002
        },
        {
            "authors": [
                "Roberto Pieraccini",
                "David Suendermann",
                "Krishna Dayanidhi",
                "Jackson Liscombe."
            ],
            "title": "Are we there yet? research in commercial spoken dialog systems",
            "venue": "Text, Speech and Dialogue, pages 3\u201313. Springer.",
            "year": 2009
        },
        {
            "authors": [
                "Adwait Ratnaparkhi."
            ],
            "title": "Trainable approaches to surface natural language generation and their application to conversational dialog systems",
            "venue": "Computer Speech & Language, 16(3):435\u2013455.",
            "year": 2002
        },
        {
            "authors": [
                "Alan Ritter",
                "Colin Cherry",
                "William B Dolan."
            ],
            "title": "Data-driven response generation in social media",
            "venue": "Proceedings of the Conference on Empirical Methods in Natural Language Processing, pages 583\u2013 593.",
            "year": 2011
        },
        {
            "authors": [
                "Jost Schatztnann",
                "Matthew N Stuttle",
                "Karl Weilhammer",
                "Steve Young."
            ],
            "title": "Effects of the user model on simulation-based learning of dialogue strategies",
            "venue": "Automatic Speech Recognition and Understanding, 2005 IEEE Workshop on, pages 220\u2013",
            "year": 2005
        },
        {
            "authors": [
                "Iulian V Serban",
                "Alessandro Sordoni",
                "Yoshua Bengio",
                "Aaron Courville",
                "Joelle Pineau."
            ],
            "title": "Building end-to-end dialogue systems using generative hierarchical neural network models",
            "venue": "Proc. of AAAI.",
            "year": 2015
        },
        {
            "authors": [
                "Lifeng Shang",
                "Zhengdong Lu",
                "Hang Li."
            ],
            "title": "Neural responding machine for short-text conversation",
            "venue": "ACL-IJCNLP, pages 1577\u20131586.",
            "year": 2015
        },
        {
            "authors": [
                "Alessandro Sordoni",
                "Michel Galley",
                "Michael Auli",
                "Chris Brockett",
                "Yangfeng Ji",
                "Meg Mitchell",
                "Jian-Yun Nie",
                "Jianfeng Gao",
                "Bill Dolan."
            ],
            "title": "A neural network approach to context-sensitive generation of conversational responses",
            "venue": "Proc. of NAACL-HLT.",
            "year": 2015
        },
        {
            "authors": [
                "Ilya Sutskever",
                "Oriol Vinyals",
                "Quoc V Le."
            ],
            "title": "Sequence to sequence learning with neural networks",
            "venue": "Advances in neural information processing systems (NIPS), pages 3104\u20133112.",
            "year": 2014
        },
        {
            "authors": [
                "J\u00f6rg Tiedemann."
            ],
            "title": "News from OPUS \u2013 a collection of multilingual parallel corpora with tools and interfaces",
            "venue": "Recent advances in natural language processing, volume 5, pages 237\u2013248.",
            "year": 2009
        },
        {
            "authors": [
                "Oriol Vinyals",
                "Quoc Le."
            ],
            "title": "A neural conversational model",
            "venue": "Proc. of ICML Deep Learning Workshop.",
            "year": 2015
        },
        {
            "authors": [
                "Wolfgang Wahlster",
                "Alfred Kobsa."
            ],
            "title": "User models in dialog systems",
            "venue": "Springer.",
            "year": 1989
        },
        {
            "authors": [
                "Marilyn A Walker",
                "Rashmi Prasad",
                "Amanda Stent."
            ],
            "title": "A trainable generator for recommendations in multimodal dialog",
            "venue": "INTERSPEECH.",
            "year": 2003
        },
        {
            "authors": [
                "Marilyn A Walker",
                "Ricky Grant",
                "Jennifer Sawyer",
                "Grace I Lin",
                "Noah Wardrip-Fruin",
                "Michael Buell."
            ],
            "title": "Perceived or not perceived: Film character models for expressive nlg",
            "venue": "Interactive Storytelling, pages 109\u2013121. Springer.",
            "year": 2011
        },
        {
            "authors": [
                "Marilyn A Walker",
                "Grace I Lin",
                "Jennifer Sawyer."
            ],
            "title": "An annotated corpus of film dialogue for learning and characterizing character style",
            "venue": "LREC, pages 1373\u20131378.",
            "year": 2012
        },
        {
            "authors": [
                "William Yang Wang",
                "Ron Artstein",
                "Anton Leuski",
                "David Traum."
            ],
            "title": "Improving spoken dialogue understanding using phonetic mixture models",
            "venue": "FLAIRS Conference.",
            "year": 2011
        },
        {
            "authors": [
                "Tsung-Hsien Wen",
                "Milica Gasic",
                "Nikola Mrk\u0161i\u0107",
                "PeiHao Su",
                "David Vandyke",
                "Steve Young."
            ],
            "title": "Semantically conditioned LSTM-based natural language generation for spoken dialogue systems",
            "venue": "Proc. of EMNLP, pages 1711\u20131721, Lisbon, Portu-",
            "year": 2015
        },
        {
            "authors": [
                "Kaisheng Yao",
                "Geoffrey Zweig",
                "Baolin Peng."
            ],
            "title": "Attention with intention for a neural network conversation model",
            "venue": "CoRR, abs/1510.08565.",
            "year": 2015
        },
        {
            "authors": [
                "Steve Young",
                "Milica Ga\u0161i\u0107",
                "Simon Keizer",
                "Fran\u00e7ois Mairesse",
                "Jost Schatzmann",
                "Blaise Thomson",
                "Kai Yu."
            ],
            "title": "The hidden information state model: A practical framework for pomdp-based spoken dialogue management",
            "venue": "Computer Speech & Language,",
            "year": 2010
        }
    ],
    "sections": [
        {
            "text": "We present persona-based models for handling the issue of speaker consistency in neural response generation. A speaker model encodes personas in distributed embeddings that capture individual characteristics such as background information and speaking style. A dyadic speakeraddressee model captures properties of interactions between two interlocutors. Our models yield qualitative performance improvements in both perplexity and BLEU scores over baseline sequence-to-sequence models, with similar gains in speaker consistency as measured by human judges."
        },
        {
            "heading": "1 Introduction",
            "text": "As conversational agents gain traction as user interfaces, there has been growing research interest in training naturalistic conversation systems from large volumes of human-to-human interactions (Ritter et al., 2011; Sordoni et al., 2015; Vinyals and Le, 2015; Li et al., 2016). One major issue for these data-driven systems is their propensity to select the response with greatest likelihood\u2014in effect a consensus response of the humans represented in the training data. Outputs are frequently vague or non-committal (Li et al., 2016), and when not, they can be wildly inconsistent, as illustrated in Table 1.\nIn this paper, we address the challenge of consistency and how to endow data-driven systems with the coherent \u201cpersona\u201d needed to model humanlike behavior, whether as personal assistants, per-\n* The entirety of this work was conducted at Microsoft.\nsonalized avatar-like agents, or game characters.1 For present purposes, we will define PERSONA as the character that an artificial agent, as actor, plays or performs during conversational interactions. A persona can be viewed as a composite of elements of identity (background facts or user profile), language behavior, and interaction style. A persona is also adaptive, since an agent may need to present different facets to different human interlocutors depending on the interaction.\nFortunately, neural models of conversation generation (Sordoni et al., 2015; Shang et al., 2015; Vinyals and Le, 2015; Li et al., 2016) provide a straightforward mechanism for incorporating personas as embeddings. We therefore explore two per-\n1(Vinyals and Le, 2015) suggest that the lack of a coherent personality makes it impossible for current systems to pass the Turing test.\nar X\niv :1\n60 3.\n06 15\n5v 2\n[ cs\n.C L\n] 8\nJ un\n2 01\n6\nsona models, a single-speaker SPEAKER MODEL and a dyadic SPEAKER-ADDRESSEE MODEL, within a sequence-to-sequence (SEQ2SEQ) framework (Sutskever et al., 2014). The Speaker Model integrates a speaker-level vector representation into the target part of the SEQ2SEQ model. Analogously, the Speaker-Addressee model encodes the interaction patterns of two interlocutors by constructing an interaction representation from their individual embeddings and incorporating it into the SEQ2SEQ model. These persona vectors are trained on human-human conversation data and used at test time to generate personalized responses. Our experiments on an open-domain corpus of Twitter conversations and dialog datasets comprising TV series scripts show that leveraging persona vectors can improve relative performance up to 20% in BLEU score and 12% in perplexity, with a commensurate gain in consistency as judged by human annotators."
        },
        {
            "heading": "2 Related Work",
            "text": "This work follows the line of investigation initiated by Ritter et al. (2011) who treat generation of conversational dialog as a statistical machine translation (SMT) problem. Ritter et al. (2011) represents a break with previous and contemporaneous dialog work that relies extensively on hand-coded rules, typically either building statistical models on top of heuristic rules or templates (Levin et al., 2000; Young et al., 2010; Walker et al., 2003; Pieraccini et al., 2009; Wang et al., 2011) or learning generation rules from a minimal set of authored rules or labels (Oh and Rudnicky, 2000; Ratnaparkhi, 2002; Banchs and Li, 2012; Ameixa et al., 2014; Nio et al., 2014; Chen et al., 2013). More recently (Wen et al., 2015) have used a Long Short-Term Memory (LSTM) (Hochreiter and Schmidhuber, 1997) to learn from unaligned data in order to reduce the heuristic space of sentence planning and surface realization.\nThe SMT model proposed by Ritter et al., on the other hand, is end-to-end, purely data-driven, and contains no explicit model of dialog structure; the model learns to converse from human-to-human conversational corpora. Progress in SMT stemming from the use of neural language models (Sutskever et al., 2014; Gao et al., 2014; Bahdanau et al., 2015; Luong et al., 2015) has inspired efforts to extend these neural techniques to SMT-based conversational response generation. Sordoni et al. (2015) augments Ritter et al. (2011) by rescoring out-\nputs using a SEQ2SEQ model conditioned on conversation history. Other researchers have recently used SEQ2SEQ to directly generate responses in an end-to-end fashion without relying on SMT phrase tables (Serban et al., 2015; Shang et al., 2015; Vinyals and Le, 2015). Serban et al. (2015) propose a hierarchical neural model aimed at capturing dependencies over an extended conversation history. Recent work by Li et al. (2016) measures mutual information between message and response in order to reduce the proportion of generic responses typical of SEQ2SEQ systems. Yao et al. (2015) employ an intention network to maintain the relevance of responses.\nModeling of users and speakers has been extensively studied within the standard dialog modeling framework (e.g., (Wahlster and Kobsa, 1989; Kobsa, 1990; Schatztnann et al., 2005; Lin and Walker, 2011)). Since generating meaningful responses in an open-domain scenario is intrinsically difficult in conventional dialog systems, existing models often focus on generalizing character style on the basis of qualitative statistical analysis (Walker et al., 2012; Walker et al., 2011). The present work, by contrast, is in the vein of the SEQ2SEQ models of Vinyals and Le (2015) and Li et al. (2016), enriching these models by training persona vectors directly from conversational data and relevant side-information, and incorporating these directly into the decoder."
        },
        {
            "heading": "3 Sequence-to-Sequence Models",
            "text": "Given a sequence of inputs X = {x1, x2, ..., xnX}, an LSTM associates each time step with an input gate, a memory gate and an output gate, respectively denoted as it, ft and ot. We distinguish e and h where et denotes the vector for an individual text unit (for example, a word or sentence) at time step t while ht denotes the vector computed by the LSTM model at time t by combining et and ht\u22121. ct is the cell state vector at time t, and \u03c3 denotes the sigmoid function. Then, the vector representation ht for each time step t is given by:\nit ft ot lt\n =  \u03c3 \u03c3 \u03c3\ntanh\nW \u00b7 [ ht\u22121est ]\n(1)\nct = ft \u00b7 ct\u22121 + it \u00b7 lt (2)\nhst = ot \u00b7 tanh(ct) (3)\nwhere Wi, Wf , Wo, Wl \u2208 RK\u00d72K . In SEQ2SEQ generation tasks, each input X is paired with a sequence of outputs to predict: Y = {y1, y2, ..., ynY }. The LSTM defines a distribution over outputs and sequentially predicts tokens using a softmax function:\np(Y |X) = ny\u220f t=1 p(yt|x1, x2, ..., xt, y1, y2, ..., yt\u22121)\n= ny\u220f t=1 exp(f(ht\u22121, eyt))\u2211 y\u2032 exp(f(ht\u22121, ey\u2032))\nwhere f(ht\u22121, eyt) denotes the activation function between ht\u22121 and eyt . Each sentence terminates with a special end-of-sentence symbol EOS. In keeping with common practices, inputs and outputs use different LSTMs with separate parameters to capture different compositional patterns.\nDuring decoding, the algorithm terminates when an EOS token is predicted. At each time step, either a greedy approach or beam search can be adopted for word prediction."
        },
        {
            "heading": "4 Personalized Response Generation",
            "text": "Our work introduces two persona-based models: the Speaker Model, which models the personality of the respondent, and the Speaker-Addressee Model which models the way the respondent adapts their speech to a given addressee \u2014 a linguistic phenomenon known as lexical entrainment (Deutsch and Pechmann, 1982)."
        },
        {
            "heading": "4.1 Notation",
            "text": "For the response generation task, let M denote the input word sequence (message) M = {m1,m2, ...,mI}. R denotes the word sequence in response to M , where R = {r1, r2, ..., rJ , EOS} and J is the length of the response (terminated by an EOS token). rt denotes a word token that is associated with a K dimensional distinct word embedding et. V is the vocabulary size."
        },
        {
            "heading": "4.2 Speaker Model",
            "text": "Our first model is the Speaker Model, which models the respondent alone. This model represents each individual speaker as a vector or embedding, which encodes speaker-specific information (e.g., dialect, register, age, gender, personal information) that influences the content and style of her responses. Note that these attributes are not explicitly annotated, which would be tremendously\nexpensive for our datasets. Instead, our model manages to cluster users along some of these traits (e.g., age, country of residence) based on the responses alone.\nFigure 1 gives a brief illustration of the Speaker Model. Each speaker i \u2208 [1, N ] is associated with a user-level representation vi \u2208 RK\u00d71. As in standard SEQ2SEQ models, we first encode message S into a vector representation hS using the source LSTM. Then for each step in the target side, hidden units are obtained by combining the representation produced by the target LSTM at the previous time step, the word representations at the current time step, and the speaker embedding vi:\nit ft ot lt\n =  \u03c3 \u03c3 \u03c3\ntanh\nW \u00b7  ht\u22121est\nvi  (4) ct = ft \u00b7 ct\u22121 + it \u00b7 lt (5)\nhst = ot \u00b7 tanh(ct) (6)\nwhereW \u2208 R4K\u00d73K . In this way, speaker information is encoded and injected into the hidden layer at each time step and thus helps predict personalized responses throughout the generation process. The Speaker embedding {vi} is shared across all conversations that involve speaker i. {vi} are learned by back propagating word prediction errors to each neural component during training.\nAnother useful property of this model is that it helps infer answers to questions even if the evidence is not readily present in the training set. This is important as the training data does not contain explicit information about every attribute of each user (e.g., gender, age, country of residence). The model learns speaker representations based on conversational content produced by different speakers, and speakers producing similar responses tend to have similar embeddings, occupying nearby positions in the vector space. This way, the training data of speakers nearby in vector space help increase the generalization capability of the speaker model. For example, consider two speakers i and j who sound distinctly British, and who are therefore close in speaker embedding space. Now, suppose that, in the training data, speaker i was asked Where do you live? and responded in the UK. Even if speaker j was never asked the same question, this answer can help influence a good response from speaker j, and this without explicitly labeled geo-location information."
        },
        {
            "heading": "4.3 Speaker-Addressee Model",
            "text": "A natural extension of the Speaker Model is a model that is sensitive to speaker-addressee interaction patterns within the conversation. Indeed, speaking style, register, and content does not vary only with the identity of the speaker, but also with that of the addressee. For example, in scripts for the TV series Friends used in some of our experiments, the character Ross often talks differently to his sister Monica than to Rachel, with whom he is engaged in an on-again off-again relationship throughout the series.\nThe proposed Speaker-Addressee Model operates as follows: We wish to predict how speaker i would respond to a message produced by speaker j. Similarly to the Speaker model, we associate each speaker with a K dimensional speaker-level representation, namely vi for user i and vj for user j. We obtain an interactive representation Vi,j \u2208 RK\u00d71 by linearly combining user vectors vi and vj in an attempt to model the interactive style of user i towards user j,\nVi,j = tanh(W1 \u00b7 vi +W2 \u00b7 v2) (7)\nwhere W1,W2 \u2208 RK\u00d7K . Vi,j is then linearly incorporated into LSTM models at each step in the target: \nit ft ot lt\n =  \u03c3 \u03c3 \u03c3\ntanh\nW \u00b7  ht\u22121est\nVi,j\n (8)\nct = ft \u00b7 ct\u22121 + it \u00b7 lt (9)\nhst = ot \u00b7 tanh(ct) (10)\nVi,j depends on both speaker and addressee and the same speaker will thus respond differently to a message from different interlocutors. One potential issue with Speaker-Addressee modelling is the difficulty involved in collecting a large-scale training dataset in which each speaker is involved in conversation with a wide variety of people. Like the Speaker Model, however, the SpeakerAddressee Model derives generalization capabilities from speaker embeddings. Even if the two speakers at test time (i and j) were never involved in the same conversation in the training data, two speakers i\u2032 and j\u2032 who are respectively close in embeddings may have been, and this can help modelling how i should respond to j."
        },
        {
            "heading": "4.4 Decoding and Reranking",
            "text": "For decoding, the N-best lists are generated using the decoder with beam size B = 200. We set a maximum length of 20 for the generated candidates. Decoding operates as follows: At each time step, we first examine allB \u00d7B possible next-word candidates, and add all hypothesis ending with an EOS token to the N-best list. We then preserve the top-B unfinished hypotheses and move to the next word position.\nTo deal with the issue that SEQ2SEQ models tend to generate generic and commonplace responses such as I don\u2019t know, we follow Li et al. (2016) by reranking the generated N-best list using\na scoring function that linearly combines a length penalty and the log likelihood of the source given the target:\nlog p(R|M,v) + \u03bb log p(M |R) + \u03b3|R| (11)\nwhere p(R|M, v) denotes the probability of the generated response given the message M and the respondent\u2019s speaker ID. |R| denotes the length of the target and \u03b3 denotes the associated penalty weight. We optimize \u03b3 and \u03bb on N-best lists of response candidates generated from the development set using MERT (Och, 2003) by optimizing BLEU. To compute p(M |R), we train an inverse SEQ2SEQ model by swapping messages and responses. We trained standard SEQ2SEQ models for p(M |R) with no speaker information considered."
        },
        {
            "heading": "5 Datasets",
            "text": ""
        },
        {
            "heading": "5.1 Twitter Persona Dataset",
            "text": "Data Collection Training data for the Speaker Model was extracted from the Twitter FireHose for the six-month period beginning January 1, 2012. We limited the sequences to those where the responders had engaged in at least 60 (and at most 300) 3-turn conversational interactions during the period, in other words, users who reasonably frequently engaged in conversation. This yielded a set of 74,003 users who took part in a minimum of 60 and a maximum of 164 conversational turns (average: 92.24, median: 90). The dataset extracted using responses by these \u201cconversationalists\u201d contained 24,725,711 3-turn sliding-window (context-message-response) conversational sequences.\nIn addition, we sampled 12000 3-turn conversations from the same user set from the Twitter FireHose for the three-month period beginning July 1, 2012, and set these aside as development, validation, and test sets (4000 conversational sequences each). Note that development, validation, and test sets for this data are single-reference, which is by design. Multiple reference responses would typically require acquiring responses from different people, which would confound different personas.\nTraining Protocols We trained four-layer SEQ2SEQ models on the Twitter corpus following the approach of (Sutskever et al., 2014). Details are as follows:\n\u2022 4 layer LSTM models with 1,000 hidden cells for each layer. \u2022 Batch size is set to 128.\n\u2022 Learning rate is set to 1.0. \u2022 Parameters are initialized by sampling from\nthe uniform distribution [\u22120.1, 0.1]. \u2022 Gradients are clipped to avoid gradient explo-\nsion with a threshold of 5. \u2022 Vocabulary size is limited to 50,000. \u2022 Dropout rate is set to 0.2.\nSource and target LSTMs use different sets of parameters. We ran 14 epochs, and training took roughly a month to finish on a Tesla K40 GPU machine.\nAs only speaker IDs of responses were specified when compiling the Twitter dataset, experiments on this dataset were limited to the Speaker Model."
        },
        {
            "heading": "5.2 Twitter Sordoni Dataset",
            "text": "The Twitter Persona Dataset was collected for this paper for experiments with speaker ID information. To obtain a point of comparison with prior state-of-the-art work (Sordoni et al., 2015; Li et al., 2016), we measure our baseline (non-persona) LSTM model against prior work on the dataset of (Sordoni et al., 2015), which we call the Twitter Sordoni Dataset. We only use its test-set portion, which contains responses for 2114 context and messages. It is important to note that the Sordoni dataset offers up to 10 references per message, while the Twitter Persona dataset has only 1 reference per message. Thus BLEU scores cannot be compared across the two Twitter datasets (BLEU scores on 10 references are generally much higher than with 1 reference). Details of this dataset are in (Sordoni et al., 2015)."
        },
        {
            "heading": "5.3 Television Series Transcripts",
            "text": "Data Collection For the dyadic SpeakerAddressee Model we used scripts from the American television comedies Friends2 and The Big Bang Theory,3 available from Internet Movie Script Database (IMSDb).4 We collected 13 main characters from the two series in a corpus of 69,565 turns. We split the corpus into training/development/testing sets, with development and testing sets each of about 2,000 turns.\nTraining Since the relatively small size of the dataset does not allow for training an open domain dialog model, we adopted a domain adaption strategy where we first trained a standard SEQ2SEQ\n2https://en.wikipedia.org/wiki/Friends 3https://en.wikipedia.org/wiki/The_\nBig_Bang_Theory 4http://www.imsdb.com\nmodels using a much larger OpenSubtitles (OSDb) dataset (Tiedemann, 2009), and then adapting the pre-trained model to the TV series dataset.\nThe OSDb dataset is a large, noisy, open-domain dataset containing roughly 60M-70M scripted lines spoken by movie characters. This dataset does not specify which character speaks each subtitle line, which prevents us from inferring speaker turns. Following Vinyals et al. (2015), we make the simplifying assumption that each line of subtitle constitutes a full speaker turn.5 We trained standard SEQ2SEQ models on OSDb dataset, following the protocols already described in Section 5.1. We run 10 iterations over the training set.\nWe initialize word embeddings and LSTM parameters in the Speaker Model and the SpeakerAddressee model using parameters learned from OpenSubtitles datasets. User embeddings are randomly initialized from [\u22120.1, 0.1]. We then ran 5 additional epochs until the perplexity on the development set stabilized."
        },
        {
            "heading": "6 Experiments",
            "text": ""
        },
        {
            "heading": "6.1 Evaluation",
            "text": "Following (Sordoni et al., 2015; Li et al., 2016) we used BLEU (Papineni et al., 2002) for parameter tuning and evaluation. BLEU has been shown to correlate well with human judgment on the response generation task, as demonstrated in (Galley et al., 2015). Besides BLEU scores, we also report perplexity as an indicator of model capability."
        },
        {
            "heading": "6.2 Baseline",
            "text": "Since our main experiments are with a new dataset (the Twitter Persona Dataset), we first show that our LSTM baseline is competitive with the state-of-\n5This introduces a degree of noise as consecutive lines are not necessarily from the same scene or two different speakers.\nthe-art (Li et al., 2016) on an established dataset, the Twitter Sordoni Dataset (Sordoni et al., 2015). Our baseline is simply our implementation of the LSTM-MMI of (Li et al., 2016), so results should be relatively close to their reported results. Table 2 summarizes our results against prior work. We see that our system actually does better than (Li et al., 2016), and we attribute the improvement to a larger training corpus, the use of dropout during training, and possibly to the \u201cconversationalist\u201d nature of our corpus."
        },
        {
            "heading": "6.3 Results",
            "text": "We first report performance on the Twitter Persona dataset. Perplexity is reported in Table 3. We observe about a 10% decrease in perplexity for the Speaker model over the standard SEQ2SEQ model. In terms of BLEU scores (Table 4), a significant performance boost is observed for the Speaker model over the standard SEQ2SEQ model, yielding an increase of 21% in the maximum likelihood (MLE) setting and 11.7% for mutual information setting (MMI). In line with findings in (Li et al., 2016), we observe a consistent performance boost introduced by the MMI objective function over a standard SEQ2SEQ model based on the MLE objective function. It is worth noting that our persona models are more beneficial to the MLE models than to the MMI models. This result is intuitive as the persona models help make Standard LSTM MLE outputs more informative and less bland, and thus make the use of MMI less critical.\nFor the TV Series dataset, perplexity and BLEU scores are respectively reported in Table 5 and Table 6. As can be seen, the Speaker and SpeakerAddressee models respectively achieve perplexity values of 25.4 and 25.0 on the TV-series dataset,\n7.0% and 8.4% percent lower than the correspondent standard SEQ2SEQ models. In terms of BLEU score, we observe a similar performance boost as on the Twitter dataset, in which the Speaker model and the Speaker-Addressee model outperform the standard SEQ2SEQ model by 13.7% and 10.6%. By comparing the Speaker-Addressee model against the Speaker model on the TV Series dataset, we do not observe a significant difference. We suspect that this is primarily due to the relatively small size of the dataset where the interactive patterns might not be fully captured. Smaller values of perplexity are observed for the Television Series dataset than the Twitter dataset, the perplexity of which is over 40, presumably due to the noisier nature of Twitter dialogues."
        },
        {
            "heading": "6.4 Qualitative Analysis",
            "text": "Diverse Responses by Different Speakers Table 7 represents responses generated by persona models in response to three different input questions. We randomly selected 10 speakers (without cherry-picking) from the original Twitter dataset. We collected their user level representations from a speaker look-up table and integrated them into the decoding models. The model tends to generate specific responses for different people in response to the factual questions.6\nTable 8 shows responses generated from the Speaker-Addressee Model using the TV-series dataset. Interestingly, we regularly observe that this model is sensitive to the identity of the addressee, generating words specifically targeted at that addressee (e.g., her name). For example, the model produces Of course, I love you, Emily in response to an input from Emily. Also, the model generates Of course I love you. ( kisses him), where the pronoun \u201chim\u201d accurately identifies the gender of the addressee.\n6There appears to be a population bias in the training set that favors British users.\nHuman Evaluation We conducted a human evaluation of outputs from the Speaker Model, using a crowdsourcing service. Since we cannot expect crowdsourced human judges to know or attempt to learn the ground truth of Twitter users who are not well-known public figures, we designed our experiment to evaluate the consistency of outputs associated with the speaker IDs. To this end, we collected 24 pairs of questions for which we would expect\nresponses to be consistent if the persona model is coherent. For example, responses to the questions What country do you live in? and What city do you live in? would be considered consistent if the answers were England and London respectively, but not if they were UK and Chicago. Similarly, the responses to Are you vegan or vegetarian? and Do you eat beef? are consistent if the answers generated are vegan and absolutely not, but not if they are vegan and I love beef. We collected 20 pairs of outputs for randomly-selected personas provided by the Speaker Model for each question pair (480 response pairs total). We also obtained the corresponding outputs from the baseline MMI-enhanced SEQ2SEQ system.\nSince our purpose is to measure the gain in consistency over the baseline system, we presented the pairs of answers system-pairwise, i.e., 4 responses, 2 from each system, displayed on the screen, and asked judges to decide which of the two systems was more consistent. The position in which the system pairs were presented on the screen was randomized. The two systems were judged on 5-point zero-sum scale, assigning a score of 2 (-2) if one system was judged more (less) consistent than the other, and 1 (-1) if one was rated \u201csomewhat\u201d more (less) consistent. Ties were assigned a score of zero. Five judges rated each pair and their scores were averaged and remapped into 5 equal-width bins. After discarding ties, we found the persona model was judged either \u201cmore consistent\u201d or \u201csomewhat more consistent\u201d in 56.7% of cases. If we ignore the \u201csomewhat more consistent\u201d judgments, the persona model wins in 6.1% of cases, compared\nwith only 1.6% for the baseline model. It should be emphasized that the baseline model is a strong baseline, since it represents the consensus of all 70K Twitter users in the dataset7.\nTable 9 illustrates how consistency is an emergent property of two arbitrarily selected users. The model is capable of discovering the relations between different categories of location such as London and the UK, Jakarta and Indonesia. However, the model also makes inconsistent response decisions, generating different answers in the second example in response to questions asking about age or major. Our proposed persona models integrate user embeddings into the LSTM, and thus can be viewed as encapsulating a trade-off between a persona-specific generation model and a general conversational model.\n7I\u2019m not pregnant is an excellent consensus answer to the question Are you pregnant?, while I\u2019m pregnant is consistent as a response only in the case of someone who also answers the question Are you a guy or a girl? with something in the vein of I\u2019m a girl."
        },
        {
            "heading": "7 Conclusions",
            "text": "We have presented two persona-based response generation models for open-domain conversation generation. There are many other dimensions of speaker behavior, such as mood and emotion, that are beyond the scope of the current paper and must be left to future work.\nAlthough the gains presented by our new models are not spectacular, the systems outperform our baseline SEQ2SEQ systems in terms of BLEU, perplexity, and human judgments of speaker consistency. We have demonstrated that by encoding personas in distributed representations, we are able to capture personal characteristics such as speaking style and background information. In the SpeakerAddressee model, moreover, the evidence suggests that there is benefit in capturing dyadic interactions.\nOur ultimate goal is to be able to take the profile of an arbitrary individual whose identity is not known in advance, and generate conversations that accurately emulate that individual\u2019s persona in terms of linguistic response behavior and other salient characteristics. Such a capability will dramatically change the ways in which we interact with dialog agents of all kinds, opening up rich new possibilities for user interfaces. Given a sufficiently large training corpus in which a sufficiently rich variety of speakers is represented, this objective does not seem too far-fetched."
        },
        {
            "heading": "Acknowledgments",
            "text": "We with to thank Stephanie Lukin, Pushmeet Kohli, Chris Quirk, Alan Ritter, and Dan Jurafsky for helpful discussions."
        }
    ],
    "title": "A Persona-Based Neural Conversation Model",
    "year": 2016
}